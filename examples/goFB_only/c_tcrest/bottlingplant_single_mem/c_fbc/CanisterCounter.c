// This file is generated by FBC.

#include "CanisterCounter.h"
#include <string.h>
#include <stdio.h>

/* Function block initialization function */
void CanisterCounterinit(CanisterCounter* me)
{
    me->_entered = false;
    me->_input.event.LasersChanged = 0;
    me->_output.event.CanisterCountChanged = 0;
}

/* ECC algorithms */
void CanisterCounter_ChangeCount(CanisterCounter* me)
{
if(me->DoorSiteLaser) {
 me->CanisterCount++;
}
if(me->RejectBinLaser) {
 me->CanisterCount--;
}
if(me->AcceptBinLaser) {
 me->CanisterCount--;
}
//printf("Canister count:%i\n", me->CanisterCount);
}

/* Function block execution function */
void CanisterCounterrun(CanisterCounter* me)
{
    int _PRET_BOUND_i = 0;
    me->_output.event.CanisterCountChanged = 0;

    if (me->_input.event.LasersChanged) {
        me->DoorSiteLaser = me->_DoorSiteLaser;
        me->RejectBinLaser = me->_RejectBinLaser;
        me->AcceptBinLaser = me->_AcceptBinLaser;
    }
	#pragma loopbound min 1 max 2
    for (;;) {
        // State: Start
        if (!me->_entered) {
            CanisterCounter_ChangeCount(me);
            me->_output.event.CanisterCountChanged = 1;
            me->_entered = true;
            break;
        }
        else {
            if (me->_input.event.LasersChanged) {
                me->_entered = false;
                continue;
            }
            break;
        }
        break;
    }
    if (me->_output.event.CanisterCountChanged) {
        me->_CanisterCount = me->CanisterCount;
    }

    me->_input.event.LasersChanged = 0;
}

